<!DOCTYPE html>
<html>
<head>
    <title>Network Connectivity Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        button { padding: 10px 20px; font-size: 16px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Network Connectivity Test for VAPI</h1>
    <p>This will test if your network can connect to VAPI's servers.</p>
    
    <div id="results"></div>
    
    <button onclick="runTests()">Run Network Tests</button>
    
    <script>
        function addResult(message, success) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test ${success ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${success ? '‚úÖ' : '‚ùå'}</strong> ${message}`;
            results.appendChild(div);
        }
        
        async function runTests() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="test">üîÑ Running tests...</div>';
            
            // Test 1: Basic HTTP connectivity to VAPI
            try {
                const response = await fetch('https://api.vapi.ai/health', {
                    method: 'GET',
                    mode: 'no-cors'
                });
                addResult('VAPI API endpoint accessible', true);
            } catch (error) {
                addResult(`VAPI API endpoint blocked: ${error.message}`, false);
            }
            
            // Test 2: Daily.co connectivity
            try {
                const response = await fetch('https://gs.daily.co', {
                    method: 'GET',
                    mode: 'no-cors'
                });
                addResult('Daily.co servers accessible', true);
            } catch (error) {
                addResult(`Daily.co servers blocked: ${error.message}`, false);
            }
            
            // Test 3: WebSocket test
            try {
                const ws = new WebSocket('wss://gs.daily.co');
                ws.onopen = () => {
                    addResult('WebSocket connections allowed', true);
                    ws.close();
                };
                ws.onerror = (error) => {
                    addResult('WebSocket connections blocked', false);
                };
                ws.onclose = () => {
                    addResult('WebSocket connection closed normally', true);
                };
                
                // Timeout after 5 seconds
                setTimeout(() => {
                    if (ws.readyState === WebSocket.CONNECTING) {
                        ws.close();
                        addResult('WebSocket connection timed out', false);
                    }
                }, 5000);
                
            } catch (error) {
                addResult(`WebSocket test failed: ${error.message}`, false);
            }
            
            // Test 4: Check if we're behind a proxy/firewall
            setTimeout(() => {
                const wsTest = new WebSocket('wss://echo.websocket.org');
                wsTest.onopen = () => {
                    addResult('General WebSocket connectivity working', true);
                    wsTest.close();
                };
                wsTest.onerror = () => {
                    addResult('All WebSocket connections blocked (likely firewall)', false);
                };
            }, 1000);
        }
    </script>
</body>
</html>
